<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reze RP â€“ Gemini 2.5 Pro</title>
  <link rel="stylesheet" href="styles.css?v=7" />
</head>
<body>
<div class="app" id="app">
  <header>
    <h1>Reze RP <span class="pill">Gemini 2.5 Pro â€¢ GitHub Pages</span></h1>
    <div class="row">
      <button class="btn" id="newChat">ìƒˆ ëŒ€í™”</button>
      <button class="btn" id="exportChat">ëŒ€í™” ë‚´ë³´ë‚´ê¸°</button>
      <input id="importChatFile" type="file" accept="application/json" style="display:none" />
      <button class="btn" id="importChat">ê°€ì ¸ì˜¤ê¸°</button>
    </div>
  </header>

  <!-- Tabs -->
  <nav class="tabs">
    <button class="tab active" data-tab="chat">ì±„íŒ…</button>
    <button class="tab" data-tab="editor">í”„ë¡¬í”„íŠ¸Â·ì›”ë“œÂ·ìºë¦­í„°</button>
    <button class="tab" data-tab="gallery">ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬</button>
  </nav>

  <!-- Page 1: Chat -->
  <section class="page chat-grid active" id="page_chat">
    <div class="mini-conn">
      <span class="tag">API Key</span>
      <input id="miniApiKey" type="password" placeholder="AIza..." />
      <span class="tag">Model</span>
      <input id="miniModel" type="text" value="gemini-2.5-pro" />
      <button class="btn" id="miniSave">ì €ì¥</button>
      <button class="btn" id="miniTest">í…ŒìŠ¤íŠ¸</button>
      <div class="muted" id="miniState"></div>
    </div>

    <div id="chat"></div>

    <div class="composer">
      <div class="bar">
        <textarea id="userInput" placeholder="ë ˆì œì—ê²Œ ë§í•˜ê¸°... Shift+Enter ì¤„ë°”ê¿ˆ"></textarea>
        <div class="stack">
          <button class="btn accent" id="send">ë³´ë‚´ê¸° â</button>
          <button class="btn danger" id="stop">ì¤‘ì§€</button>
        </div>
      </div>
      <div class="muted" style="margin-top:6px">í‚¤ëŠ” ë¸Œë¼ìš°ì € ë¡œì»¬ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤. í•˜ë“œì½”ë”© ê¸ˆì§€.</div>
    </div>
  </section>

  <!-- Page 2: Editor -->
  <section class="page panel" id="page_editor">
    <div class="card">
      <h3>ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸(ê³ ì •)</h3>
      <textarea id="systemPrompt" placeholder="ì˜ˆ: ì‘ë‹µ ì²« ì¤„ì— <emotion:...> 1ê°œ í¬í•¨."></textarea>
      <label><input type="checkbox" id="lockSystem"> ëŒ€í™”ë§ˆë‹¤ ìë™ì£¼ì…</label>
    </div>
    <div class="card">
      <h3>ì›”ë“œ ì •ë³´(ê³ ì •)</h3>
      <textarea id="worldInfo" placeholder="ì²´ì¸ì†Œë§¨ ì„¸ê³„ê´€, ì‹œê°„ëŒ€, ì¸ë¬¼ê´€ê³„ ë“±"></textarea>
      <label><input type="checkbox" id="lockWorld"> ëŒ€í™”ë§ˆë‹¤ ìë™ì£¼ì…</label>
    </div>
    <div class="card">
      <h3>ìºë¦­í„°(ë ˆì œ) ì§€ì¹¨</h3>
      <label>ì´ë¦„</label><input id="charName" type="text" value="ë ˆì œ" />
      <label>ìºë¦­í„° í”„ë¡¬í”„íŠ¸</label>
      <textarea id="charPrompt" placeholder="ë ˆì œì˜ ì„±ê²©Â·ë§ë²„ë¦‡Â·ê¸ˆì§€ì–´Â·ë¡¤í”Œ ê·œì¹™"></textarea>
      <label><input type="checkbox" id="lockChar"> ëŒ€í™”ë§ˆë‹¤ ìë™ì£¼ì…</label>
    </div>

    <div class="card">
      <h3>ê°ì • ë§¤í•‘(JSON)</h3>
      <p class="muted">ì˜ˆ: {"neutral":"reze_neutral.png","listening":"reze_listening.gif","angry":"reze_angry.gif","happy":"reze_happy.gif","laughing":"reze_laughing.gif","cold_smile":"reze_cold_smile.png","blush":"reze_blush.png","cafe_work":"reze_cafe_work.png","slack_off":"reze_slack_off.png","unpleasant":"reze_unpleasant.png","sad":"reze_unpleasant.png"}
</p>
      <textarea id="emotionMap"></textarea>
      <div class="row" style="margin-top:8px"><button class="btn" id="saveLore">ì €ì¥</button></div>
    </div>

    <div class="card" style="grid-column:1 / -1">
      <h3>ì•„ë°”íƒ€</h3>
      <label>ì‚¬ìš©ì ì•„ë°”íƒ€ URL (ê¸°ë³¸: assets/reze/profile/user.png)</label>
      <input id="userAvatar" type="text" placeholder="assets/reze/profile/user.png" />
      <label>ë ˆì œ ì•„ë°”íƒ€ URL (ê¸°ë³¸: assets/reze/profile/reze.png)</label>
      <input id="assistantAvatar" type="text" placeholder="assets/reze/profile/reze.png" />
      <div class="row" style="margin-top:8px"><button class="btn" id="saveAvatars">ì•„ë°”íƒ€ ì €ì¥</button></div>
    </div>

    <div class="card" style="grid-column:1 / -1">
      <h3>ì²« ë©”ì‹œì§€(ê·¸ë¦¬íŒ…)</h3>
      <label>ë¬¸êµ¬</label>
      <textarea id="greetingText" placeholder="ì˜ˆ: <emotion:happy> ì•ˆë…•! ë‚œ ë ˆì œ."></textarea>
      <label><input type="checkbox" id="greetingOn"> ìƒˆ ëŒ€í™” ì‹œì‘ ì‹œ ìë™ í‘œì‹œ</label>
      <div class="row" style="margin-top:8px"><button class="btn" id="saveGreeting">ê·¸ë¦¬íŒ… ì €ì¥</button></div>
    </div>
  </section>

  <!-- Page 3: Gallery + BGM -->
  <section class="page panel" id="page_gallery">
    <div class="card" style="grid-column:1 / -1">
      <h3>ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬</h3>
      <p class="muted">
        ê¶Œì¥: <code>assets/reze/manifest.json</code> (ë¬¸ìì—´ ë°°ì—´ ë˜ëŠ” ê°ì²´ ë°°ì—´).<br>
        ì˜ˆ: <code>["reze_happy.gif","reze_angry.gif"]</code> ë˜ëŠ” <code>[{"src":"reze_happy.gif","tag":"happy"}]</code>
      </p>
      <div class="row">
        <input id="assetsBase" type="text" placeholder="assets/reze" value="assets/reze" />
        <input id="manifestPath" type="text" placeholder="assets/reze/manifest.json" value="assets/reze/manifest.json" />
        <button class="btn" id="reload">ê°¤ëŸ¬ë¦¬ ìƒˆë¡œê³ ì¹¨</button>
      </div>
      <div id="gallery" class="gallery" style="margin-top:10px"></div>
    </div>

    <div class="card" style="grid-column:1 / -1">
      <h3>BGM</h3>
      <p class="muted">MP3ë¥¼ <code>assets/bgm/track.mp3</code>ë¡œ ë„£ìœ¼ë©´ ìë™ì¬ìƒ ì‹œë„. ë§‰íˆë©´ ìš°í•˜ë‹¨ ë²„íŠ¼ í‘œì‹œ.</p>
      <label>URL (ê³ ì •)</label>
      <input id="bgmUrl" type="text" value="assets/bgm/track.mp3" readonly />
      <div class="row" style="margin-top:8px">
        <label style="display:flex;align-items:center;gap:6px"><input type="checkbox" id="bgmLoop" checked/> ë°˜ë³µ</label>
        <input id="bgmVol" type="range" min="0" max="1" step="0.01" class="range" style="flex:1" value="0.4"/>
        <button class="btn" id="bgmPlay">ì¬ìƒ/ì¼ì‹œì •ì§€</button>
      </div>
      <audio id="bgmAudio" preload="auto" playsinline></audio>
    </div>
  </section>
</div>

<!-- Lightbox -->
<div id="lightbox" class="lightbox" aria-modal="true" role="dialog">
  <div class="frame">
    <header>
      <div class="title" id="lightboxTitle"></div>
      <button class="btn" id="lightboxClose">ë‹«ê¸°</button>
    </header>
    <div class="body"><img id="lightboxImg" alt="preview"></div>
  </div>
</div>

<!-- Autoplay fallback button -->
<button id="bgmUnmute" class="floating" style="display:none">ğŸ”Š BGM ì¼œê¸°</button>

<script src="app.js?v=7"></script>
</body>
</html>
