<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reze RP – Gemini 2.5 Pro</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<div class="app" id="app">
  <header>
    <h1>Reze RP <span class="pill">Gemini 2.5 Pro • GitHub Pages</span></h1>
    <div class="row">
      <button class="btn" id="newChat">새 대화</button>
      <button class="btn" id="exportChat">대화 내보내기</button>
      <input id="importChatFile" type="file" accept="application/json" style="display:none" />
      <button class="btn" id="importChat">가져오기</button>
    </div>
  </header>

  <!-- Tabs -->
  <nav class="tabs">
    <button class="tab active" data-tab="chat">채팅</button>
    <button class="tab" data-tab="editor">프롬프트·월드·캐릭터</button>
    <button class="tab" data-tab="gallery">이미지 갤러리</button>
  </nav>

  <!-- Page 1: Chat -->
  <section class="page chat-grid active" id="page_chat">
    <div class="mini-conn">
      <span class="tag">API Key</span>
      <input id="miniApiKey" type="password" placeholder="AIza..." />
      <span class="tag">Model</span>
      <input id="miniModel" type="text" value="gemini-2.5-pro" />
      <button class="btn" id="miniSave">저장</button>
      <div class="muted" id="miniState"></div>
    </div>

    <div id="chat"></div>

    <div class="composer">
      <div class="bar">
        <textarea id="userInput" placeholder="레제에게 말하기... Shift+Enter 줄바꿈"></textarea>
        <div class="stack">
          <button class="btn accent" id="send">보내기 ⏎</button>
          <button class="btn danger" id="stop">중지</button>
        </div>
      </div>
      <div class="muted" style="margin-top:6px">키는 브라우저 로컬에만 저장됩니다. 하드코딩 금지.</div>
    </div>
  </section>

  <!-- Page 2: Editor -->
  <section class="page panel" id="page_editor">
    <div class="card">
      <h3>시스템 프롬프트(고정)</h3>
      <textarea id="systemPrompt" placeholder="예: 응답 첫 줄에 <emotion:...> 1개 포함."></textarea>
      <label><input type="checkbox" id="lockSystem"> 대화마다 자동주입</label>
    </div>
    <div class="card">
      <h3>월드 정보(고정)</h3>
      <textarea id="worldInfo" placeholder="체인소맨 세계관, 시간대, 인물관계 등"></textarea>
      <label><input type="checkbox" id="lockWorld"> 대화마다 자동주입</label>
    </div>
    <div class="card">
      <h3>캐릭터(레제) 지침</h3>
      <label>이름</label><input id="charName" type="text" value="레제" />
      <label>캐릭터 프롬프트</label>
      <textarea id="charPrompt" placeholder="레제의 성격·말버릇·금지어·롤플 규칙"></textarea>
      <label><input type="checkbox" id="lockChar"> 대화마다 자동주입</label>
    </div>
    <div class="card">
      <h3>감정 매핑(JSON)</h3>
      <p class="muted">예: {"happy":"reze_happy","sad":"reze_sad","angry":"reze_angry","neutral":"reze_neutral"}</p>
      <textarea id="emotionMap"></textarea>
      <div class="row" style="margin-top:8px"><button class="btn" id="saveLore">저장</button></div>
    </div>
  </section>

  <!-- Page 3: Gallery -->
  <section class="page panel" id="page_gallery">
    <div class="card" style="grid-column:1 / -1">
      <h3>이미지 갤러리</h3>
      <p class="muted">
        권장: <code>assets/reze/manifest.json</code> (예: ["reze_happy.jpg","reze_sad.gif"]).<br>
        없으면 감정키 기반 경로를 추정해 로드.
      </p>
      <div class="row">
        <input id="assetsBase" type="text" placeholder="assets/reze" value="assets/reze" />
        <input id="manifestPath" type="text" placeholder="assets/reze/manifest.json" value="assets/reze/manifest.json" />
        <button class="btn" id="reload">갤러리 새로고침</button>
      </div>
      <div id="gallery" class="gallery" style="margin-top:10px"></div>
    </div>
  </section>
</div>

<script src="app.js"></script>
</body>
</html>
